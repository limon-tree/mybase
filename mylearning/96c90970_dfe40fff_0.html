<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<style>
			body, table{font-family: 微软雅黑}
			
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div>
			<h1 id="gdb-">
				<h1 id="gdb调试任意函数" style="box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 2.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.2; cursor: text; border-bottom: 1px solid rgb(238, 238, 238); width: inherit; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">gdb调试任意函数</span>
				</h1>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">使用gdb调试时，有的函数只在某些路径上会执行到，而触发这些路径执行的条件构造起来比较麻烦，比如某个server在接收到READ请求时，会调用do_read进行响应，这时如果我们想调试do_read函数，就必须在客户端构造一个READ请求来触发。</span>
				</p>
				<pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c++" style="box-sizing: border-box; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c++" style="box-sizing: border-box; text-align: left; height: auto; position: relative; overflow: hidden; background: inherit;"><div style="box-sizing: border-box; overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="box-sizing: border-box; color: inherit; font: inherit; position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scroll" tabindex="-1" style="box-sizing: content-box; overflow: hidden; z-index: 3; height: 23px; outline: 0px; position: relative; background: inherit;"><div class="CodeMirror-sizer" style="box-sizing: border-box; position: relative; margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="box-sizing: border-box; position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation" style="box-sizing: border-box; padding: 0px 0px 0px 4px; cursor: text;"><div role="presentation" style="box-sizing: border-box; position: relative; outline: none;"><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"></div><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"></div><div style="box-sizing: border-box; position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style="box-sizing: border-box;"><div class="CodeMirror-activeline" style="box-sizing: border-box; position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground" style="box-sizing: border-box; position: absolute; z-index: 0; background: inherit;"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="box-sizing: border-box; position: absolute; top: 0px; bottom: 0px; z-index: 4; left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"><span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">do_read（const</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">ReadRequest</span><span class="cm-operator" style="box-sizing: border-box; color: rgb(152, 26, 26);">&amp;</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">req</span>);</span></pre></div></div></div></div></div></div><div style="box-sizing: border-box; position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div></div></div></pre>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">假设我们知道do_read调用时参数ReadRequest的具体内容，能否直接使用gdb显式的调试do_read，且看下面这个例子。</span>
				</p>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">main函数里没有显式调用get_capacity函数，如果我们想要调试这个函数，最直观的一种方式，当然是将get_capacity加到main里，让其出现在调用路径中即可调试。</span>
				</p>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">gdb的jump可以让程序跳转到任意位置执行，实验了一下，结果是跳转到get_capacity里开始执行时，出现Segmentation fault，因为参数Box的空间没有分配。在了解参数传递顺序及栈布局的情况下，可通过一些出栈、入栈操作，在jump到get_capacity前将参数先准备好，这样get_capacity调用时，就不会有问题，但这样做太过复杂。</span>
				</p>
				<pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c++" style="box-sizing: border-box; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c++" style="box-sizing: border-box; text-align: left; height: auto; position: relative; overflow: hidden; background: inherit;"><div style="box-sizing: border-box; overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="box-sizing: border-box; color: inherit; font: inherit; position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scroll" tabindex="-1" style="box-sizing: content-box; overflow: hidden; z-index: 3; height: 207px; outline: 0px; position: relative; background: inherit;"><div class="CodeMirror-sizer" style="box-sizing: border-box; position: relative; margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="box-sizing: border-box; position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation" style="box-sizing: border-box; padding: 0px 0px 0px 4px; cursor: text;"><div role="presentation" style="box-sizing: border-box; position: relative; outline: none;"><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"><pre style="box-sizing: border-box; font-family: inherit; padding: 0px 4px; border-radius: 0px; border-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: static; overflow: visible; word-break: normal; width: inherit;"><span style="box-sizing: border-box;"></span></pre></div><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"></div><div style="box-sizing: border-box; position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style="box-sizing: border-box;"><div class="CodeMirror-activeline" style="box-sizing: border-box; position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground" style="box-sizing: border-box; position: absolute; z-index: 0; background: inherit;"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="box-sizing: border-box; position: absolute; top: 0px; bottom: 0px; z-index: 4; left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"><span class="cm-keyword" style="box-sizing: border-box; color: rgb(119, 0, 136);">struct</span> <span class="cm-def" style="box-sizing: border-box; color: rgb(0, 0, 255);">Box</span> { <span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">length</span>; <span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">width</span>; <span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">height</span>; }; </span></pre></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"><span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-def" style="box-sizing: border-box; color: rgb(0, 0, 255);">get_capacity</span>(<span class="cm-keyword" style="box-sizing: border-box; color: rgb(119, 0, 136);">const</span> <span class="cm-keyword" style="box-sizing: border-box; color: rgb(119, 0, 136);">struct</span> <span class="cm-def" style="box-sizing: border-box; color: rgb(0, 0, 255);">Box</span><span class="cm-operator" style="box-sizing: border-box; color: rgb(152, 26, 26);">&amp;</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">box</span>) { </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">capacity</span> <span class="cm-operator" style="box-sizing: border-box; color: rgb(152, 26, 26);">=</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">box</span>.<span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">length</span> <span class="cm-operator" style="box-sizing: border-box; color: rgb(152, 26, 26);">*</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">box</span>.<span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">width</span> <span class="cm-operator" style="box-sizing: border-box; color: rgb(152, 26, 26);">*</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">box</span>.<span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">height</span>; <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">printf</span>(<span class="cm-string" style="box-sizing: border-box; color: rgb(170, 17, 17);">"box capacity: %d\n"</span>, <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">capacity</span>); <span class="cm-keyword" style="box-sizing: border-box; color: rgb(119, 0, 136);">return</span> <span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">capacity</span>; </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">} </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"><span class="cm-variable-3" style="box-sizing: border-box; color: rgb(0, 136, 85);">int</span> <span class="cm-def" style="box-sizing: border-box; color: rgb(0, 0, 255);">main</span>() </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">{ </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable" style="box-sizing: border-box; color: rgb(0, 0, 0);">printf</span>(<span class="cm-string" style="box-sizing: border-box; color: rgb(170, 17, 17);">"main called no functions\n"</span>); </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword" style="box-sizing: border-box; color: rgb(119, 0, 136);">return</span> <span class="cm-number" style="box-sizing: border-box; color: rgb(17, 102, 68);">0</span>; </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="box-sizing: border-box; position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div></div></div></pre>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">gdb的call可以在调试时显式调用函数，需要先把参数准备好。如下所示，在main里设置断点，然后分配出一个box的内存，并对box进行赋值，最后将其最为参数传递给get_capacity函数，get_capacity函数被正确的调用，通过在get_capacity设置断点即可对它进行调试。</span>
				</p>
				<pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="box-sizing: border-box; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="" style="box-sizing: border-box; text-align: left; height: auto; position: relative; overflow: hidden; background: inherit;"><div style="box-sizing: border-box; overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="box-sizing: border-box; color: inherit; font: inherit; position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scroll" tabindex="-1" style="box-sizing: content-box; overflow: hidden; z-index: 3; height: 115px; outline: 0px; position: relative; background: inherit;"><div class="CodeMirror-sizer" style="box-sizing: border-box; position: relative; margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="box-sizing: border-box; position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation" style="box-sizing: border-box; padding: 0px 0px 0px 4px; cursor: text;"><div role="presentation" style="box-sizing: border-box; position: relative; outline: none;"><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"><pre style="box-sizing: border-box; font-family: inherit; padding: 0px 4px; border-radius: 0px; border-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: static; overflow: visible; word-break: normal; width: inherit;"><span style="box-sizing: border-box;"></span></pre></div><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"></div><div style="box-sizing: border-box; position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style="box-sizing: border-box;"><div class="CodeMirror-activeline" style="box-sizing: border-box; position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground" style="box-sizing: border-box; position: absolute; z-index: 0; background: inherit;"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="box-sizing: border-box; position: absolute; top: 0px; bottom: 0px; z-index: 4; left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) set $box = (Box*)malloc(sizeof(Box)) </span></pre></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) set $box-&gt;length = 3 </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) set $box-&gt;width = 4 </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) set $box-&gt;height = 5 </span></pre><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) call get_capacity(*$box) box capacity: 60 $1 = 60</span></pre></div></div></div></div></div><div style="box-sizing: border-box; position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div></div></div></pre>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">针对上面这种方式，存在两个疑问，求达人解惑。</span>
				</p>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">直接使用box对象而不是指针时，传递时有问题，如下：</span>
				</p>
				<pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="box-sizing: border-box; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="" style="box-sizing: border-box; text-align: left; height: auto; position: relative; overflow: hidden; background: inherit;"><div style="box-sizing: border-box; overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="box-sizing: border-box; color: inherit; font: inherit; position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scroll" tabindex="-1" style="box-sizing: content-box; overflow: hidden; z-index: 3; height: 46px; outline: 0px; position: relative; background: inherit;"><div class="CodeMirror-sizer" style="box-sizing: border-box; position: relative; margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="box-sizing: border-box; position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation" style="box-sizing: border-box; padding: 0px 0px 0px 4px; cursor: text;"><div role="presentation" style="box-sizing: border-box; position: relative; outline: none;"><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"><pre style="box-sizing: border-box; font-family: inherit; padding: 0px 4px; border-radius: 0px; border-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: static; overflow: visible; word-break: normal; width: inherit;"><span style="box-sizing: border-box;"></span></pre></div><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"></div><div style="box-sizing: border-box; position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style="box-sizing: border-box;"><div class="CodeMirror-activeline" style="box-sizing: border-box; position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground" style="box-sizing: border-box; position: absolute; z-index: 0; background: inherit;"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="box-sizing: border-box; position: absolute; top: 0px; bottom: 0px; z-index: 4; left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) set $box = *(Box*)malloc(sizeof(Box)) </span></pre></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) call get_capacity($box) Attempt to take address of value not located in memory.</span></pre></div></div></div></div></div><div style="box-sizing: border-box; position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div></div></div></pre>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box;">不能直接使用new来构造对象，对于复杂的类（尤其是拥有虚函数的情况），上面的方式没办法工作。</span>
				</p>
				<pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="box-sizing: border-box; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="" style="box-sizing: border-box; text-align: left; height: auto; position: relative; overflow: hidden; background: inherit;"><div style="box-sizing: border-box; overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="box-sizing: border-box; color: inherit; font: inherit; position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scroll" tabindex="-1" style="box-sizing: content-box; overflow: hidden; z-index: 3; height: 23px; outline: 0px; position: relative; background: inherit;"><div class="CodeMirror-sizer" style="box-sizing: border-box; position: relative; margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="box-sizing: border-box; position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation" style="box-sizing: border-box; padding: 0px 0px 0px 4px; cursor: text;"><div role="presentation" style="box-sizing: border-box; position: relative; outline: none;"><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"><pre style="box-sizing: border-box; font-family: inherit; padding: 0px 4px; border-radius: 0px; border-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: static; overflow: visible; word-break: normal; width: inherit;"><span style="box-sizing: border-box;"></span></pre></div><div class="CodeMirror-measure" style="box-sizing: border-box; position: absolute; width: 1126px; height: 0px; overflow: hidden; visibility: hidden;"></div><div style="box-sizing: border-box; position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style="box-sizing: border-box;"><div class="CodeMirror-activeline" style="box-sizing: border-box; position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground" style="box-sizing: border-box; position: absolute; z-index: 0; background: inherit;"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="box-sizing: border-box; position: absolute; top: 0px; bottom: 0px; z-index: 4; left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation" style="box-sizing: border-box; font-family: inherit; break-inside: avoid; padding: 0px 4px; border-radius: 0px; border-top-width: 0px; border-right: none; border-bottom-width: 0px; border-left-width: 0px; background: 0px 0px; font-size: inherit; margin: 0px; white-space: pre-wrap; overflow-wrap: break-word; color: inherit; z-index: 2; position: relative; overflow: visible; word-break: normal; width: inherit;"><span role="presentation" style="box-sizing: border-box; padding-right: 0.1px;">(gdb) set $box = new Box() A syntax error in expression, near `new Box()'.</span></pre></div></div></div></div></div></div><div style="box-sizing: border-box; position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div></div></div></pre>
				<p style="box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; width: inherit; position: relative; color: rgb(51, 51, 51); font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;">&nbsp;
				</p>
			</h1>
		</div>
	
<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>